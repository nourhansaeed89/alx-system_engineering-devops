#!/usr/bin/env bash

# Check if Nginx configuration file exists
nginx_conf="/etc/nginx/sites-enabled/default"
if [ ! -f "$nginx_conf" ]; then
    echo "Nginx configuration file not found at $nginx_conf"
    exit 1
fi

# Update the port in the Nginx configuration file
sed -i 's/listen\s*8080/listen 80/g' "$nginx_conf"

# Restart Nginx service
service nginx restart

# Check if Nginx is now listening on port 80
if ! netstat -tuln | grep -q ':80'; then
    echo "Failed to configure Nginx to listen on port 80."
    exit 1
fi

echo "Nginx is now listening on port 80."
